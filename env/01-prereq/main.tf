// -----------------------------------------------------------------------------------------------//
// --------------------------------   TAGS VARIABLE   --------------------------------------------//
// -----------------------------------------------------------------------------------------------//
variable "tags" {
  description = "A map of tags to add to all resources"
  type        = map(string)
}

// -----------------------------------------------------------------------------------------------//
// --------------------------------   TF PROVIDER   ----------------------------------------------//
// -----------------------------------------------------------------------------------------------//
provider "aws" {
  region = "us-east-1"
  skip_region_validation = true
  default_tags {
    tags = var.tags
  }
}

// -----------------------------------------------------------------------------------------------//
// --------------------------------   TF BACKEND   -----------------------------------------------//
// -----------------------------------------------------------------------------------------------//
terraform {

  // Backend - AWS Landing Zone Lab
  backend "s3" {
    bucket         = "" #fill later
    region = "us-east-1"
    skip_region_validation = true
    key            = "01-prereq/terraform.tfstate"
    dynamodb_table = "" #fill later
    encrypt        = true
  }
}

// -----------------------------------------------------------------------------------------------//
// --------------------------------   TF VERSION   -----------------------------------------------//
// -----------------------------------------------------------------------------------------------//
terraform {
  required_version = ">= 1.0.7"
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = ">= 4.31"
    }
  }
}

// -----------------------------------------------------------------------------------------------//
// --------------------------------   TF MODULES   -----------------------------------------------//
// -----------------------------------------------------------------------------------------------//
module "prereq" {
  source = "../../modules/01-prereq"

  master_prefix                                = "my"
  env_prefix                                   = "kafka"
  app_prefix                                   = "project"

}

// -----------------------------------------------------------------------------------------------//
// --------------------------------   TF OUTPUTS   -----------------------------------------------//
// -----------------------------------------------------------------------------------------------//
output "kms_alias" {
  value = module.prereq.kms_alias
}